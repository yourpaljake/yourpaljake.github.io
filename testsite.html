<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Test Circle Mover</title>
    <style>
      #circle {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        background-color: red;
        position: absolute;
      }
    </style>
  </head>
  <body>
    <div id="circle"></div>

    <script>
      // Get the circle element
      var circle = document.getElementById('circle');

      // Initialize variables
      var isMouseDown = false;
      var initialMouseX = 0;
      var initialMouseY = 0;
      var initialCircleX = 0;
      var initialCircleY = 0;

      // Event listener for mouse and touch down
      circle.addEventListener('mousedown', handleStart);
      circle.addEventListener('touchstart', handleStart);

      function handleStart(event) {
        event.preventDefault();

        //Determines if user is using mouse or touchscreen
        if (event.type === 'mousedown') {
          isMouseDown = true;
          initialMouseX = event.clientX;
          initialMouseY = event.clientY;
        } else if (event.type === 'touchstart') {
          isMouseDown = true;
          initialMouseX = event.touches[0].clientX;
          initialMouseY = event.touches[0].clientY;
        } 

        //add offset for circle position calculations
        initialCircleX = circle.offsetLeft;
        initialCircleY = circle.offsetTop;

        //Add listeners for move and stop
        document.addEventListener('mousemove', handleMove);
        document.addEventListener('touchmove', handleMove);
        document.addEventListener('mouseup', handleEnd);
        document.addEventListener('touchend', handleEnd);
      }

      function handleMove(event) {
        event.preventDefualt();
        
        var currentMouseX;
        var currentMouseY;

        //Accomidate different input types
        if (event.type === 'mousemove') {
          currentMouseX = event.clientX;
          currentMouseY = event.clientY;
        } else if (event.type === 'touchmove') {
          currentMouseX = event.touches[0].clientX;
          currentMouseY = event.touches[0].clientY;
        }

        //Calculate position delta
        var deltaX = currentMouseX - initialMouseX;
        var deltaY = currentMouseY - initialMouseY;
          
        // Calculate the new circle position
        var newCircleX = initialCircleX + deltaX;
        var newCircleY = initialCircleY + deltaY;

        // Restrict the circle's movement not to go below 500 pixels or off screen
        var viewportWidth = window.innerWidth;
        var viewportHeight = window.innerHeight;
        var maxCircleX = viewportWidth - circle.offsetWidth;
        var maxCircleY = viewportHeight - circle.offsetHeight;
        newCircleX = Math.max(0, Math.min(newCircleX, maxCircleX));
        newCircleY = Math.max(0, Math.min(newCircleY, maxCircleY));
        newCircleY = Math.min(newCircleY, 500);

        // Update the circle's position
        circle.style.left = newCircleX + 'px';
        circle.style.top = newCircleY + 'px';
    }

    function handleStop() {
      isMouseDown = false;

      //Remove listeners for move and stop
      document.removeEventListener('mousemove', circleMove);
      document.removeEventListener('touchmove', circleMove);
      document.removeEventListener('mouseup', circleStop);
      document.removeEventListener('touchend', circleStop);
    }
    </script>
  </body>
</html>
